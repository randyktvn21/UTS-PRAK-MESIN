<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prediksi Kualitas Wine</title>
    <style>
        :root {
            font-family: "Segoe UI", Arial, sans-serif;
            color: #f4f6fb;
            background-color: #070a11;
        }

        body {
            margin: 0;
            padding: 0;
            background: radial-gradient(circle at top, #121829, #05070d 70%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .card {
            width: min(980px, 96vw);
            background: #0f1524;
            border-radius: 20px;
            padding: 36px 42px 44px;
            box-shadow: 0 30px 70px rgba(0, 0, 0, 0.55);
            border: 1px solid #202a42;
        }

        h1 {
            margin: 0 0 8px;
            font-size: clamp(1.75rem, 3vw, 2.25rem);
        }

        p.subtitle {
            margin: 0 0 28px;
            color: #95a1c6;
        }

        form {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 18px 24px;
        }

        label {
            font-weight: 600;
            font-size: 0.9rem;
            color: #b7c3ff;
            display: block;
            margin-bottom: 6px;
        }

        input,
        select {
            width: 100%;
            padding: 10px 12px;
            border-radius: 10px;
            border: 1px solid #273353;
            background: #050a17;
            color: #f2f5ff;
            font-size: 0.95rem;
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        input:focus,
        select:focus {
            outline: none;
            border-color: #6d87ff;
            box-shadow: 0 0 0 3px rgba(109, 135, 255, 0.2);
        }

        .actions {
            grid-column: 1 / -1;
            display: flex;
            gap: 16px;
            margin-top: 12px;
        }

        button {
            border: none;
            border-radius: 12px;
            padding: 12px 28px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.15s, box-shadow 0.15s;
        }

        button[type="submit"] {
            background: linear-gradient(120deg, #4c74ff, #9a5cff);
            color: #fff;
            box-shadow: 0 18px 32px rgba(88, 120, 255, 0.35);
        }

        button.secondary {
            background: #1b2236;
            color: #cfd9ff;
            border: 1px solid #2a3350;
        }

        button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            box-shadow: none;
        }

        .result {
            margin-top: 32px;
            padding: 24px;
            border-radius: 16px;
            background: #11182b;
            border: 1px solid #233257;
            display: none;
        }

        .result.active {
            display: block;
        }

        .result h2 {
            margin-top: 0;
            margin-bottom: 8px;
        }

        .probabilities {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 12px;
            margin-top: 16px;
        }

        .prob-card {
            padding: 16px;
            border-radius: 14px;
            background: #0c111f;
            border: 1px solid #1f2742;
            text-align: center;
        }

        .result-info {
            margin-top: 20px;
            padding: 16px;
            border-radius: 12px;
            background: #0d1423;
            border: 1px solid #1f2b46;
            font-size: 0.95rem;
            color: #c5cff5;
        }

        .result-info ul {
            margin: 10px 0 0;
            padding-left: 18px;
            color: #9fb0e4;
        }

        .result-info li {
            margin-bottom: 4px;
        }

        .error-box {
            margin-top: 24px;
            padding: 16px;
            border-radius: 12px;
            background: #3a0d14;
            color: #ffd1d6;
            border: 1px solid #742b38;
            display: none;
        }

        .form-hint {
            grid-column: 1 / -1;
            padding: 14px 18px;
            background: #121a2d;
            border: 1px solid #1d2a47;
            border-radius: 12px;
            font-size: 0.93rem;
            color: #a8b5e6;
        }
    </style>
</head>
<body>
    <div class="card">
        <h1>Prediksi Kualitas Anggur</h1>
        <p class="subtitle">Masukkan parameter kimia wine secara manual.</p>

        <form id="wine-form">
            <div class="form-hint">
                Isi angka sesuai hasil pengukuran. Gunakan titik (.) sebagai pemisah desimal dan pastikan satuan mengikuti dataset asli.
            </div>
            <div>
                <label for="type">Jenis Wine</label>
                <select id="type" name="type" required>
                    <option value="" disabled selected>Pilih jenis</option>
                    <option value="white">Putih</option>
                    <option value="red">Merah</option>
                </select>
            </div>
            <div>
                <label for="fixed_acidity">Fixed Acidity</label>
                <input type="number" step="0.01" id="fixed_acidity" name="fixed_acidity" placeholder="contoh 6.5" required>
            </div>
            <div>
                <label for="volatile_acidity">Volatile Acidity</label>
                <input type="number" step="0.001" id="volatile_acidity" name="volatile_acidity" placeholder="contoh 0.3" required>
            </div>
            <div>
                <label for="citric_acid">Citric Acid</label>
                <input type="number" step="0.001" id="citric_acid" name="citric_acid" placeholder="contoh 0.4" required>
            </div>
            <div>
                <label for="residual_sugar">Residual Sugar</label>
                <input type="number" step="0.01" id="residual_sugar" name="residual_sugar" placeholder="contoh 8.5" required>
            </div>
            <div>
                <label for="chlorides">Chlorides</label>
                <input type="number" step="0.0001" id="chlorides" name="chlorides" placeholder="contoh 0.05" required>
            </div>
            <div>
                <label for="free_sulfur_dioxide">Free Sulfur Dioxide</label>
                <input type="number" step="0.1" id="free_sulfur_dioxide" name="free_sulfur_dioxide" placeholder="contoh 35" required>
            </div>
            <div>
                <label for="total_sulfur_dioxide">Total Sulfur Dioxide</label>
                <input type="number" step="0.1" id="total_sulfur_dioxide" name="total_sulfur_dioxide" placeholder="contoh 120" required>
            </div>
            <div>
                <label for="density">Density</label>
                <input type="number" step="0.00001" id="density" name="density" placeholder="contoh 0.9931" required>
            </div>
            <div>
                <label for="pH">pH</label>
                <input type="number" step="0.01" id="pH" name="pH" placeholder="contoh 3.2" required>
            </div>
            <div>
                <label for="sulphates">Sulphates</label>
                <input type="number" step="0.01" id="sulphates" name="sulphates" placeholder="contoh 0.6" required>
            </div>
            <div>
                <label for="alcohol">Alcohol</label>
                <input type="number" step="0.1" id="alcohol" name="alcohol" placeholder="contoh 10.5" required>
            </div>

            <div class="actions">
                <button type="submit" id="submit-btn">Prediksi Kualitas</button>
                <button type="button" class="secondary" id="reset-btn">Reset Form</button>
            </div>
        </form>

        <div class="result" id="result-box">
            <h2 id="quality-label"></h2>
            <p id="quality-desc"></p>
            <div class="probabilities">
                <div class="prob-card">
                    <strong>Rendah</strong>
                    <p id="prob-low">- %</p>
                </div>
                <div class="prob-card">
                    <strong>Sedang</strong>
                    <p id="prob-mid">- %</p>
                </div>
                <div class="prob-card">
                    <strong>Tinggi</strong>
                    <p id="prob-high">- %</p>
                </div>
            </div>
            <div class="result-info">
                <strong>Cara membaca hasil:</strong>
                <ul>
                    <li>Label “Rendah / Sedang / Tinggi” diambil dari skor kualitas asli (0–10) pada dataset.</li>
                    <li>Persentase menunjukkan tingkat keyakinan model. Nilai tertinggi menandakan kategori yang paling mungkin.</li>
                    <li>Jika dua probabilitas berdekatan, artinya karakteristik wine berada di antara dua kelas tersebut.</li>
                </ul>
                <p style="margin-top:10px;">Anda dapat membandingkan hasil ini dengan pengguna lain dengan membagikan nilai input dan probabilitasnya.</p>
            </div>
        </div>

        <div class="error-box" id="error-box"></div>
    </div>

    <script>
        const form = document.getElementById('wine-form');
        const resultBox = document.getElementById('result-box');
        const errorBox = document.getElementById('error-box');
        const submitBtn = document.getElementById('submit-btn');
        const resetBtn = document.getElementById('reset-btn');
        function toggleLoading(state) {
            submitBtn.disabled = state;
            submitBtn.textContent = state ? 'Memproses...' : 'Prediksi Kualitas';
        }

        function clearResult() {
            resultBox.classList.remove('active');
            errorBox.style.display = 'none';
            errorBox.textContent = '';
        }

        resetBtn.addEventListener('click', () => {
            form.reset();
            clearResult();
        });

        form.addEventListener('submit', async (event) => {
            event.preventDefault();
            clearResult();
            toggleLoading(true);

            const payload = Object.fromEntries(new FormData(form).entries());

            try {
                const response = await fetch('/predict', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                const data = await response.json();

                if (!response.ok || !data.berhasil) {
                    throw new Error(data.pesan_error || 'Prediksi gagal dijalankan.');
                }

                document.getElementById('quality-label').textContent = `Kualitas: ${data.label_kualitas}`;
                document.getElementById('quality-desc').textContent = data.deskripsi_kualitas;
                document.getElementById('prob-low').textContent = `${data.probabilitas.Rendah}%`;
                document.getElementById('prob-mid').textContent = `${data.probabilitas.Sedang}%`;
                document.getElementById('prob-high').textContent = `${data.probabilitas.Tinggi}%`;

                resultBox.classList.add('active');
            } catch (err) {
                errorBox.textContent = err.message;
                errorBox.style.display = 'block';
            } finally {
                toggleLoading(false);
            }
        });
    </script>
</body>
</html>


